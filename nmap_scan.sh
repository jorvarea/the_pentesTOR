#!/bin/bash

$proxy_command="$2"

host_status=$("$proxy_command" nmap -sP "$1" | grep "Host is up" 2>/dev/null)

if [ -z "$host_status" ]; then
	 echo "The host "$1" seems to be down or is blocking our ping probes"
fi

echo -e "$host_status"
mkdir -p ${1}_info/nmap
echo "Performing basic TCP scan..."
$proxy_command nmap -sT "$1" -oN ${1}_info/nmap/basic_tcp_scan
echo "Performing service detection..."
$proxy_command nmap -sV "$1" -oN ${1}_info/nmap/service_detection
echo "Scanning for operating system"
$proxy_command nmap -O "$1" -oN ${1}_info/nmap/operating_system
echo "Scanning with the default script..."
$proxy_command nmap -sC "$1" -oN ${1}_info/nmap/default_script
echo "Scanning for vulnerabilities..."
$proxy_command nmap --script=vuln "$1" -oN ${1}_info/nmap/vulnerabilities_scan
echo "Performing UDP scan..."
$proxy_command nmap -sU "$1" -oN ${1}_info/nmap/udp_scan
echo "Performing aggressive scan..."
$proxy_command nmap -A "$1" -oN ${1}_info/nmap/aggressive_scan
echo "Performing full port scan..."
$proxy_command nmap -p- "$1" -oN ${1}_info/nmap/full_port_scan

