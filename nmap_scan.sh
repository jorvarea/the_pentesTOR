#!/bin/bash

BRIGHTBLUE="\033[1;34m"
RED="\033[31m"
RESET="\033[0m"
$proxy_command="$2"

host_status=$("$proxy_command" nmap -sP "$1" | grep "Host is up" 2>/dev/null)

if [ -z "$host_status" ]; then
	 echo -e "${RED}The host "$1" seems to be down or is blocking our ping probes${RESET}"
fi

echo -e "$host_status"
mkdir -p ${1}_info/nmap
echo -e "${BRIGHTBLUE}Performing basic TCP scan...${RESET}"
$proxy_command nmap -sT "$1" -oN ${1}_info/nmap/basic_tcp_scan
echo -e "${BRIGHTBLUE}Performing service detection...${RESET}"
$proxy_command nmap -sV "$1" -oN ${1}_info/nmap/service_detection
echo -e "${BRIGHTBLUE}Performing UDP scan...${RESET}"
$proxy_command nmap -sU "$1" -oN ${1}_info/nmap/udp_scan
echo -e "${BRIGHTBLUE}Performing full port scan...${RESET}"
$proxy_command nmap -p- "$1" -oN ${1}_info/nmap/full_port_scan
echo -e "${BRIGHTBLUE}Scanning with the default script...${RESET}"
$proxy_command nmap -sC "$1" -oN ${1}_info/nmap/default_script
echo -e "${BRIGHTBLUE}Scanning for vulnerabilities...${RESET}"
$proxy_command nmap --script=vuln "$1" -oN ${1}_info/nmap/vulnerabilities_scan
echo "${BRIGHTBLUE}Performing aggressive scan...${RESET}"
$proxy_command nmap -A "$1" -oN ${1}_info/nmap/aggressive_scan


